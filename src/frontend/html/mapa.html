<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Ruta</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body data-page="mapa">
<div id="mapa"></div>
<div id="leyenda-colores" class="leyenda-mapa">
    <div class="leyenda-titulo">Leyenda de Puntos</div>
    <div class="leyenda-item">
        <div class="leyenda-color verde"></div>
        <span>Sin novedad</span>
    </div>
    <div class="leyenda-item">
        <div class="leyenda-color amarillo"></div>
        <span>Con novedad</span>
    </div>
    <div class="leyenda-item">
        <div class="leyenda-color rojo"></div>
        <span>Con imagen</span>
    </div>
</div>

<!-- Definir initMap globalmente ANTES de cargar Google Maps -->
<script>
// Función global que Google Maps necesita
window.initMap = function() {
    console.log('Inicializando mapa desde HTML...');
    // Esta función será reemplazada por el módulo cuando se cargue
    if (window.initMapFromModule) {
        window.initMapFromModule();
    } else {
        console.log('Módulo aún no cargado, esperando...');
        // Esperar a que el módulo se cargue
        setTimeout(() => {
            if (window.initMapFromModule) {
                window.initMapFromModule();
            } else {
                console.error('Módulo no se cargó correctamente');
            }
        }, 1000);
    }
};
</script>

<!-- Cargar Google Maps después de definir initMap -->
<script async defer 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAksqUv9fz5XqluvoIla1Ih9mzwpZFls7k&callback=initMap">
</script>

<!-- Cargar el módulo después -->
<script type="module" src="../app/mapa.js"></script>
</body>
</html>
