<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Ruta</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body data-page="mapa">
<header class="site-header" data-component="site-header"></header>

<main class="page-main page-main--map">
    <div id="mapa"></div>
    <div id="leyenda-colores" class="leyenda-mapa">
        <div class="leyenda-titulo">Leyenda de Puntos</div>
        <div class="leyenda-item">
            <div class="leyenda-color verde"></div>
            <span>Sin novedad</span>
        </div>
        <div class="leyenda-item">
            <div class="leyenda-color amarillo"></div>
            <span>Con novedad</span>
        </div>
        <div class="leyenda-item">
            <div class="leyenda-color rojo"></div>
            <span>Con imagen</span>
        </div>
    </div>
</main>

<footer class="site-footer" data-component="site-footer"></footer>
<div data-component="floating-whatsapp"></div>

<script type="module" src="../app/layout.js"></script>
<script type="module" src="../app/app.js?v=2025-08-18-22-45-01"></script>

<!-- Definir initMap globalmente ANTES de cargar Google Maps -->
<script>
// Función global que Google Maps necesita
window.initMap = function() {
    console.log('Inicializando mapa desde HTML...');
    // Esta función será reemplazada por el módulo cuando se cargue
    if (window.initMapFromModule) {
        window.initMapFromModule();
    } else {
        console.log('Módulo aún no cargado, esperando...');
        // Esperar a que el módulo se cargue
        setTimeout(() => {
            if (window.initMapFromModule) {
                window.initMapFromModule();
            } else {
                console.error('Módulo no se cargó correctamente');
            }
        }, 1000);
    }
};
</script>

<!-- Cargar Google Maps después de definir initMap -->
<script async defer 
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBiEYfyRySXfikwDnnmi79LxTvD1YDuZz4&callback=initMap">
</script>

<!-- Cargar el módulo después -->
<script type="module" src="../app/mapa.js"></script>
</body>
</html>
